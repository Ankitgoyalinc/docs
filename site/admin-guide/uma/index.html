<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>UMA - Gluu Docs</title>
  

  <link rel="shortcut icon" href="../../img/gluu_favicon.ico">
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Gluu Docs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
			
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Home</a>
        
    </li>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>Admin Guide</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../introduction/">Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../getting-started/">Getting Started</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../deployment/">Deployment</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../certificates/">Certificates</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../configuration/">Configuration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../design-customizations/">Design and Customizations</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../ldap/">LDAP</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../saml/">SAML</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../openid-connect/">OpenID Connect</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">UMA</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#introduction">Introduction</a></li>
                
                    <li><a class="toctree-l4" href="#enterprise-uma">Enterprise UMA</a></li>
                
                    <li><a class="toctree-l4" href="#uma-in-action">UMA in Action</a></li>
                
            
                <li class="toctree-l3"><a href="#discovery">Discovery</a></li>
                
            
                <li class="toctree-l3"><a href="#resource-registration">Resource Registration</a></li>
                
                    <li><a class="toctree-l4" href="#register-resource-via-oxtrust">Register resource via oxTrust</a></li>
                
            
                <li class="toctree-l3"><a href="#uma-scopes">UMA Scopes</a></li>
                
                    <li><a class="toctree-l4" href="#define-uma-scopes-via-oxtrust">Define UMA Scopes via oxTrust</a></li>
                
                    <li><a class="toctree-l4" href="#implementation-specificity">Implementation specificity</a></li>
                
            
                <li class="toctree-l3"><a href="#uma-policies">UMA Policies</a></li>
                
                    <li><a class="toctree-l4" href="#define-policies">Define Policies</a></li>
                
                    <li><a class="toctree-l4" href="#algorithm">Algorithm</a></li>
                
            
                <li class="toctree-l3"><a href="#requesting-party-trust-elevation">Requesting party trust elevation</a></li>
                
            
                <li class="toctree-l3"><a href="#references">References</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../user-management/">User Management</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../personal/">Personal</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../faq/">FAQ</a>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>Reference</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../reference/api/">API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../reference/interception-scripts/">Interception Scripts</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../reference/ldap-namespace/">LDAP Namespace</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../reference/ldap-schema/">LDAP Schema</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../reference/lib/">Gluu Library</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../reference/oxAuth/">OxAuth</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../reference/oxd/">OxD</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../reference/oxTrust/">OxTrust</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../reference/mod_auth_oidc/">Apache Module</a>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>Articles</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/cache-refresh/">Cache Refresh Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/apache-saml/">Apache SAML SP Config</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/google-saml/">SAML SSO with Google</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/salesforce-sso/">SAML SSO with Salesforce</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/hobsons-saml/">SAML SSO with Hobsons</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/iis-saml/">IIS SAML Config</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/benchmarking/">Benchmarking</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/custom-attributes/">Custom Attributes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/gluu-server-ce/">Gluu CE</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/operations/">Gluu CE Operations</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/java-connect/">OpenID in Java</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/js-connect/">OpenID from JavaScript</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/java-saml/">Java SAML Library</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/scim-client/">SCIM API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/mod-auth-oidc/">mod_auth_oidc Installation Guide</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/test-shib2/">Testing Shib2</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../articles/social-login-google/">Social Login with Google</a>
        
    </li>

        
    </ul>
<li>
		
          
		
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Gluu Docs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Admin Guide &raquo;</li>
        
      
    
    <li>UMA</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/GluuFederation/docs" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p><strong>Table of Contents</strong>  </p>
<ul>
<li><a href="#introduction">Introduction</a><ul>
<li><a href="#enterprise-uma">Enterprise UMA</a></li>
<li><a href="#uma-in-action">UMA in Action</a></li>
</ul>
</li>
<li><a href="#discovery">Discovery</a><ul>
<li><a href="#discovery-references">Discovery References</a></li>
</ul>
</li>
<li><a href="#resource-registration">Resource Registration</a></li>
<li><a href="#uma-scopes">UMA Scopes</a><ul>
<li><a href="#define-uma-scopes-via-oxtrust">Define UMA Scopes via oxTrust</a></li>
<li><a href="#implementation-specificity">Implementation specificity</a><br />
        - <a href="#external-sample-ldif">External sample ldif</a><br />
        - <a href="#internal-sample-ldif">Internal sample ldif</a>  </li>
<li><a href="#register-resource-via-oxtrust">Register resource via oxTrust</a></li>
</ul>
</li>
<li><a href="#uma-policies">UMA Policies</a><ul>
<li><a href="#define-policy-in-oxtrust">Define policy in oxTrust</a></li>
<li><a href="#algorithm">Algorithm</a></li>
</ul>
</li>
<li><a href="#requesting-party-trust-elevation">Requesting party trust elevation</a>  </li>
<li><a href="#references">References</a>  </li>
</ul>
<h1 id="introduction">Introduction</h1>
<p>User-Managed Access (UMA) is an OAuth-based web-based access management protocol. The protocol is defined in a <a href="https://kantarainitiative.org/confluence/display/uma/UMA+1.0+Core+Protocol">draft version 1.0 specification</a>. A corresponding specification defines obligations of legally responsible parties that engage in UMA-conforming interactions. Although the primary use cases of UMA have centered on individual people (that is, the "users" who manage access to their own online resources), the UMA notion of authorization as a service also has relevance to modern enterprises that must secure APIs and other web resources in a developer-friendly way.</p>
<h2 id="enterprise-uma">Enterprise UMA</h2>
<p>The Gluu Server implements UMA in a way that enables the protectection of any web resource. Through the oxTrust interface, the server admin can write custom <a href="../../reference/interception-scripts/#authorization">authorization interception scripts</a> which may contain logic to grant (or forbid) access. All terminology used by this page is borrowed from UMA and Connect specs.</p>
<h2 id="uma-in-action">UMA in Action</h2>
<p>The diagrams below detail how the various UMA actors interact. </p>
<p>Some helpul definitions:
- <em>Resource Owner (RO)</em>: An OAuth resource owner that is the "user" in User-Managed Access. This is typically an end-user (a natural person) but it can also be a corporation or other legal person.
- <em>Resource Server (RS)</em>: Where the resources are held. 
- <em>Authorization Server (AS)</em>: A server that governs access based on resource owner policies.
- <em>Requesting Party (RP)</em>: An end-user, or a corporation or other legal person, that uses a client to seek access to a protected resource. The requesting party may or may not be the same party as the resource owner.
- <em>Client</em>: A web or native app that is used to access a digital resource. 
- <em>Protection API Token (PAT)</em>: An entity seeking protection API access MUST have the scope "uma_protection". An access token with at least this scope is called a protection API token (PAT) and an entity that can acquire an access token with this scope is by definition a resource server.
- <em>Requesting Party Token (RPT)</em>: the token that a client presents to a resource server when trying to access a protected resource.
- <em>Authorization API Token (AAT)</em>: An entity seeking authorization API access MUST have the scope "uma_authorization". An access token with at least this scope is called an authorization API token (AAT) and an entity that can acquire an access token with this scope is by definition a client.  </p>
<h3 id="uma-authorization-workflow">UMA Authorization Workflow</h3>
<p><img alt="UMA Authorization Workflow" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/uma/uma_parts.png" title="UMA Parts" /></p>
<h3 id="detailed-authorization-overview">Detailed Authorization Overview</h3>
<p><img alt="Detailed authorization overview" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/uma/uma_flow.png" title="UMA Parts" /></p>
<h3 id="uma-authorization-token-workflow">UMA Authorization Token Workflow</h3>
<p><img alt="UMA Authorization token workflow" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/uma/uma_token_workflow.png" title="UMA Parts" /></p>
<h3 id="uma-authorization-complete-sequence">UMA Authorization Complete Sequence</h3>
<p><img alt="UMA Authorization complete sequence diagram" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/uma/uma_very_detailed_flow.png" title="UMA Parts" /></p>
<h1 id="discovery">Discovery</h1>
<p>The Gluu Server exposes an endpoint for discovering information about UMA Provider configuration. A resource server or client can perform an HTTP GET on <code>https://domain.com/.well-known/uma-configuration</code> to retrieve a JSON object indicating the UMA Provider configuration. </p>
<p>Gluu Server response for UMA configuration MAY contain standard properties (defined by UMA specification) as well as custom properties (extension that is out of scope of this document). Gluu Server guarantees property name uniqueness within response.</p>
<p>The following is an example of a GET request to the UMA configuration discovery endpoint: </p>
<pre><code class="json">{
  &quot;version&quot;: &quot;1.0&quot;,
  &quot;issuer&quot;: &quot;https://gluuserver.org&quot;,
  &quot;pat_profiles_supported&quot;: [
    &quot;bearer&quot;
  ],
  &quot;aat_profiles_supported&quot;: [
    &quot;bearer&quot;
  ],
  &quot;rpt_profiles_supported&quot;: [
    &quot;bearer&quot;
  ],
  &quot;pat_grant_types_supported&quot;: [
    &quot;authorization_code&quot;
  ],
  &quot;aat_grant_types_supported&quot;: [
    &quot;authorization_code&quot;
  ],
  &quot;claim_profiles_supported&quot;: [
    &quot;openid&quot;
  ],
  &quot;dynamic_client_endpoint&quot;: &quot;https://gluuserver.org/oxauth/seam/resource/restv1/oxauth/register&quot;,
  &quot;token_endpoint&quot;: &quot;https://gluuserver.org/oxauth/seam/resource/restv1/oxauth/token&quot;,
  &quot;user_endpoint&quot;: &quot;https://gluuserver.org/oxauth/seam/resource/restv1/oxauth/authorize&quot;,
  &quot;introspection_endpoint&quot;: &quot;https://gluuserver.org/oxauth/seam/resource/restv1/host/status&quot;,
  &quot;resource_set_registration_endpoint&quot;: &quot;https://gluuserver.org/oxauth/seam/resource/restv1/host/rsrc&quot;,
  &quot;permission_registration_endpoint&quot;: &quot;https://gluuserver.org/oxauth/seam/resource/restv1/host/rsrc_pr&quot;,
  &quot;rpt_endpoint&quot;: &quot;https://gluuserver.org/oxauth/seam/resource/restv1/requester/rpt&quot;,
  &quot;authorization_request_endpoint&quot;: &quot;https://gluuserver.org/oxauth/seam/resource/restv1/requester/perm&quot;,
  &quot;scope_endpoint&quot;: &quot;https://gluuserver.org/oxauth/seam/resource/restv1/uma/scopes&quot;
}
</code></pre>

<p>The JSON object returned includes the following configuration information:</p>
<p><code>version</code>: The supported UMA core protocol version.</p>
<p><code>issuer</code>: The URI of the issuing authorization server.</p>
<p><code>pat_profiles_supported</code>: The supported OAuth token types used for issuing Protection API Tokens (PATs).</p>
<p><code>aat_profiles_supported</code>: The supported OAuth token types used for issuing Authorization API Tokens (AATs).</p>
<p><code>rpt_profiles_supported</code>: The supported Requesting Party Token (RPT) profiles.</p>
<p><code>pat_grant_types_supported</code>: The supported OAuth grant types used for issuing PATs.</p>
<p><code>aat_grant_types_supported</code>: The supported OAuth grant types used for issuing AATs.</p>
<p><code>token_endpoint</code>: The URI to request a PAT or AAT.</p>
<p><code>authorization_endpoint</code>: The URI to request authorization for issuing a PAT or AAT.</p>
<p><code>introspection_endpoint</code>: The URI to introspect an RPT.</p>
<p><code>resource_set_registration_endpoint</code>: The URI for a resource server to register a resource set.</p>
<p><code>permission_registration_endpoint</code>: The URI for a resource server to register a requested permission.</p>
<p><code>rpt_endpoint</code>: The URI for the client to request authorization data.</p>
<p><code>dynamic_client_endpoint</code>: The URI for registering a dynamic client.</p>
<h1 id="resource-registration">Resource Registration</h1>
<p>To let the Gluu Server know which resources are protected by UMA they must be registered. Resources are described by following properties:</p>
<ul>
<li>name: name of resource</li>
<li>scopes: scopes that are available for this resource</li>
<li>type:  type of resource (it can be string, uri or what ever, basically it is up to Resource Server what type it should be).</li>
<li>icon_uri: uri to the icon.</li>
</ul>
<p>These are standard properties however a resource description MAY contain custom properties.</p>
<h2 id="register-resource-via-oxtrust">Register resource via oxTrust</h2>
<p><img alt="oxTrust UMA Resources Interface" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/uma/uma_oxtrust_resources.png" /></p>
<p><img alt="oxTrust UMA Add Resources Interface" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/uma/uma_oxtrust_resources_add.png" /></p>
<h1 id="uma-scopes">UMA Scopes</h1>
<p>UMA Scopes are bound to resource sets and are used by policies to check whether user the specified user has access to the resource.</p>
<p>An UMA Scope is described in JSON and has following properties:</p>
<ul>
<li>name: name of scope (e.g. View photo, Edit photo)</li>
<li>icon_uri: optional property to specify icon for photo</li>
</ul>
<p>Example of typical JSON document of scope:</p>
<pre><code>{
  &quot;name&quot;: &quot;Add photo&quot;,
  &quot;icon_uri&quot;: &quot;http://www.gluu.org/icons/add_photo_scope.png&quot;
}
</code></pre>

<p>The Scope JSON MAY contain custom properties which is out of scope of this document.</p>
<h2 id="define-uma-scopes-via-oxtrust">Define UMA Scopes via oxTrust</h2>
<p><img alt="oxTrust Scopes" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/uma/uma_oxtrust_scopes.png" /></p>
<p><img alt="Add oxTrust Scopes" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/uma/uma_oxtrust_scopes_add.png" /></p>
<h2 id="implementation-specificity">Implementation specificity</h2>
<p>Scopes types:</p>
<ul>
<li>internal: hosted on oxAuth (must provide scope description);</li>
<li>external: hosted on other servers;</li>
<li>external_auto: scope hosted on other server but which is automatically added during resource set registration or update.</li>
</ul>
<p><strong>Note:</strong> there is no url for internal scope because it is configurable and depends on oxAuth hosting.</p>
<p>UMA url = uma_scopes_endpoint + "/" + oxId;</p>
<p>http://gluu.org/uma/scopes/view = http://gluu.org/uma/scopes + "/" + view</p>
<p>Under http://gluu.org/uma/scopes/view server must provide scope description as json document:</p>
<p><strong>Note:</strong> The Scope endpoint must be present in UMA configuration to make it discoverable.</p>
<h4 id="external-sample-ldif">External sample ldif</h4>
<pre><code>dn: inum=@!1111!8990!BF80,ou=scopes,ou=uma,o=@!1111,o=gluu
displayName: View
inum: @!1111!8990!BF80
objectClass: oxAuthUmaScopeDescription
objectClass: top
oxType: external
oxUrl: http://photoz.example.com/dev/scopes/view
</code></pre>

<h4 id="internal-sample-ldif">Internal sample ldif</h4>
<pre><code>dn: inum=@!1111!8990!BF80,ou=scopes,ou=uma,o=@!1111,o=gluu
displayName: View
inum: @!1111!8990!BF80
objectClass: oxAuthUmaScopeDescription
objectClass: top
oxType: internal
oxId: View
oxIconUrl: http://seed.gluu.org/uma/icons/view_scope.png
</code></pre>

<h1 id="uma-policies">UMA Policies</h1>
<p>UMA Policies protect UMA Resources. Protection of resources are made via scopes. Gluu server evaluates all policies (identified by scopes) in order to grant access.</p>
<p>UMA Policy main properties:</p>
<ul>
<li>scopes: policy protects resources by scopes.</li>
<li>authorization script: script that is evaluated in order to grant or deny access (script basically returns true of false to server).</li>
<li>name: it is best to provide an easily understandable name to the policy so that it is clear what the policy protects.  </li>
</ul>
<h2 id="define-policies">Define Policies</h2>
<p>Within the oxTrust interface the Gluu Server admin can define UMA policies (pictured below). To achieve this, navigate to Configuration &gt; Manage Custom Scripts &gt; UMA Authorization policies. </p>
<p>You can find more information on crafting UMA policies as well as an example script <a href="../../reference/interception-scripts/#authorization">here</a></p>
<p><img alt="Add UMA Policies" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/uma/uma_oxtrust_policy_add.png" /></p>
<h2 id="algorithm">Algorithm</h2>
<p>Rules:</p>
<ul>
<li>Policy protects resources based on scopes. If scope is protected by policy then during RPT authorization such policy script must return true in order to authorize access to resource, otherwise authorization is denied.</li>
<li>Scope can be protected by multiple policies. If one scope is protected by multiple policies then all policies must return true to authorize access. If at least one policy returned false then authorization is denied.
<img alt="UMA Policy Handling" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/interception_scripts/uma_policy_handling.jpg" /> </li>
</ul>
<h1 id="requesting-party-trust-elevation">Requesting party trust elevation</h1>
<p>This section defines the OX claim profile for UMA. Following is a summary:</p>
<ul>
<li>Identifying URI: http://gluu.org/uma/profiles/uma-claim-gluu-1.0</li>
<li>Profile author and contact information: Michael Schwartz and Yuriy Zabrovarnyy (info@gluu.org)</li>
<li>Updates or obsoletes: None; this profile is new.</li>
<li>Syntax and semantics of claim data: As defined below.</li>
<li>Claims gathering method: As defined below.</li>
<li>Error states: "need_reauthentication" in case AAT is not "strong" enough.</li>
<li>Security and privacy considerations: None additional.</li>
<li>Binding obligations: None additional.</li>
</ul>
<p>If an authorization server supports the OX claim profile, it MUST supply the "ox" value for one of its "claim_profiles_supported" values in its configuration data.</p>
<p>To conform to this option, the authorization server MUST do the following:</p>
<ul>
<li>send "need_reauthentication" error in case AAT does not correspond to authentication level and (or) mode of authorization policy. Together with error authorization server MUST provide:<ul>
<li>domain_auth_level - REQUIRED. authentication level required to satisfy authorization policy</li>
<li>domain_auth_mode - REQUIRED. authentication mode required to satisfy authorization policy</li>
<li>authentication_uri - OPTIONAL. authorization server authentication uri for re-authentication with required authentication level and mode</li>
</ul>
</li>
</ul>
<p>For example:</p>
<pre><code>HTTP/1.1 403 Forbidden
Content-Type: application/json
Cache-Control: no-store
{
  &quot;status&quot;: &quot;error&quot;,
  &quot;error&quot;: &quot;need_reauthentication&quot;,
  &quot;domain_auth_level&quot;:20,
  &quot;domain_auth_mode&quot;:&quot;duo&quot;,
  &quot;required_acr_level&quot;:2,
  &quot;required_acr_uri&quot;:&quot;http://example.com/global_acr&quot;,
  &quot;authentication_uri&quot;:&quot;http://seed.gluu.org/oxauth?auth_level=20&amp;auth_mode=duo&amp;client_id=...&quot;
}
</code></pre>

<h1 id="references">References</h1>
<ul>
<li><a href="http://kantarainitiative.org/confluence/display/uma/Case+Study%3A+Access+Management+2.0+for+the+Enterprise">Kantara Enterprise UMA Case Study</a> </li>
<li><a href="http://kantarainitiative.org/confluence/display/uma/UMA+1.0+Core+Protocol">UMA 1.0 Specifications</a></li>
<li><a href="https://svn.gluu.info/repository/openxdi/oxUmaDemo/RP/">UMA Requestion Party Sample implementation</a></li>
<li><a href="https://svn.gluu.info/repository/openxdi/oxUmaDemo/RS/">UMA Resource Server Sample implementation</a></li>
<li><a href="http://gluu.org">Gluu Server</a></li>
<li><a href="http://www.gluu.co/juju-draft-overview">Juju Application Security Framework (JASF) Overview</a></li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../user-management/" class="btn btn-neutral float-right" title="User Management"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../openid-connect/" class="btn btn-neutral" title="OpenID Connect"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../openid-connect/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../user-management/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
