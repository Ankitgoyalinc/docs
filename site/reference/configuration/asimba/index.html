<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../..//img/favicon_ic.ico">

        <title>Configuration - Gluu Servers</title>

        <link href="../../..//css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../..//css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../..//css/prettify-1.0.css" rel="stylesheet">
        <link href="../../..//css/base.css" rel="stylesheet">
        

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../../../"><img src="../../..//img/logo.png" ></a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    
                        <li >
                            <a href="../../../">Home</a>
                        </li>
                    
                
                
                
                    
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Admin Guide <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                            
                                
                                    <li >
                                        <a href="../../../admin-guide/introduction/">Introduction</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../admin-guide/installation/">Installation</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../admin-guide/custom-look/">Customizing Look and Feel</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../admin-guide/certificates/">Certificates</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../admin-guide/user-management/">User Management</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../admin-guide/authentication/">Authentication</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../admin-guide/saml/">SAML</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../admin-guide/openid-connect/">OpenID Connect</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../admin-guide/uma/">UMA</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../admin-guide/interception-scripts/">Interception Scripts</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../admin-guide/oxPush/">oxPush</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../admin-guide/cluster/">GLUU Cluster</a>
                                    </li>
                                
                            
                            </ul>
                        </li>
                    
                
                
                
                    
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                            
                                
                                    <li >
                                        <a href="../">Configuration</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../oxTrust/">oxTrust User Interface</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../ldap/">LDAP Schema</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../lib/">Libraries</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../api/">APIs</a>
                                    </li>
                                
                            
                            </ul>
                        </li>
                    
                
                
                
                    
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Articles <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                            
                                
                                    <li >
                                        <a href="../../../articles/gluu-server-ce/">Try Gluu Server CE - Quickstart</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../articles/apache-saml/">Apache SAML</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../articles/java-saml/">Java SAML</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../articles/google-saml/">Google SAML</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../articles/apache-oauth2/">Apache OpenID Connect / UMA</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../articles/js-connect/">JavaScript OpenID Connect RP</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../articles/java-connect/">Java OpenID Connect RP</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../articles/scim-client/">Java SCIM client</a>
                                    </li>
                                
                            
                                
                                    <li >
                                        <a href="../../../articles/benchmarking/">Gluu Server Benchmark</a>
                                    </li>
                                
                            
                            </ul>
                        </li>
                    
                
                
                
                
                </ul>
            

            
            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                <li >
                    <a rel="next" href="../shibIDP/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../opendj/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                
                <li>
                    <a href="https://github.com/GluuFederation/docs">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                <li>
                <!--<form action="." method="get" class="form-inline">-->
                    <!--<div class="search-box">-->
                        <!--<input type="text" value="" class="search-text" placeholder="Search" />-->
                        <!--<input type="submit" value="Search" class="search-tag"/>-->
                    <!--</div>-->
                <!--</form>-->

                </li>
                
            </ul>
            
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3">
                <div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
       
        <li class="main active"><a href="#asimba-configuration-with-gluu-server">Asimba configuration with Gluu Server</a></li>
        
            <li><a href="#base-installation-of-asimba-saml-proxy">Base installation of Asimba SAML Proxy</a></li>
        
            <li><a href="#adding-new-service-provider-or-identity-provider-in-asimba-server">Adding new Service Provider or Identity Provider in Asimba server</a></li>
        
       
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="asimba-configuration-with-gluu-server">Asimba configuration with Gluu Server</h1>
<h2 id="base-installation-of-asimba-saml-proxy">Base installation of Asimba SAML Proxy</h2>
<ul>
<li>Get Asimba from <a href="http://sourceforge.net/projects/asimba/files/release/">Asimba repository</a> </li>
<li>Send the war file in ~/tomcat/webapps/</li>
<li>Restart tomcat, it will extract the asimba </li>
<li>Generate the keystore for your SAML Proxy Server:<ul>
<li>Command: <code>keytool -genkeypair -keyalg RSA -alias "&lt;ALIAS_OF_KEYSTORE&gt;" -keypass &lt;PASSWORD&gt; -keystore &lt;NAME_OF_JKS&gt;.jks -storepass &lt;PASSWORD&gt;</code><ul>
<li>What is your first and last name?: Provide the hostname of Asimba server</li>
<li>What is the name of your organizational unit?: IT</li>
<li>What is the name of your organization?: Provide name</li>
<li>What is the name of your City or Locality?: city name</li>
<li>What is the name of your State or Province?: State name</li>
<li>What is the two-letter country code for this unit?: US</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="apache-configuration">Apache configuration</h3>
<h4 id="configure-idpconf">Configure "idp.conf":</h4>
<pre class="prettyprint well"><code>        &lt;Location /asimba-saml-proxy&gt;
            ProxyPass ajp://&lt;ASIMBA_HOSTNAME&gt;:8009/asimba-saml-proxy retry=5 disablereuse=On
            ProxyPassReverse ajp://&lt;ASIMBA_HOSTNAME&gt;:8009/asimba-saml-proxy

            Order allow,deny
            Allow from all
        &lt;/Location&gt;
</code></pre>
<h2 id="adding-new-service-provider-or-identity-provider-in-asimba-server">Adding new Service Provider or Identity Provider in Asimba server</h2>
<h3 id="a-new-idp-adfs-configuration-in-asimba">A new IDP / ADFS configuration in Asimba</h3>
<p>All our configurations are based on one Asimba configuration file named
"asimba.xml". It's also possible to configure Asimba with JDBC. For more info
Asimba <a href="http://sourceforge.net/p/asimba/wiki/Home/">wiki</a> is availalbe.</p>
<h4 id="required-files">Required files</h4>
<ul>
<li>Metadata of remote IDP</li>
<li>SAML certificate of remote IDP</li>
</ul>
<h4 id="configuring-asimbaxml">Configuring asimba.xml:</h4>
<ul>
<li>Grab the metadata of remote IDP and save it in some place. Make sure that user tomcat can read this xml copy. <ul>
<li>Specify this metadata in  <code>&lt;websso&gt;\&lt;method&gt;\&lt;idps&gt;</code> section. <ul>
<li><code>idp id</code> must follow the entityID of this metadata.</li>
<li><code>scoping</code> should be "false"</li>
<li>Add the static path of metadata inside <code>&lt;file&gt;</code> section. </li>
</ul>
</li>
</ul>
</li>
</ul>
<p>A sample configuration should look like below:
<code></p>
<pre class="prettyprint well"><code>        &lt;idp id="https://idp.gluu.org/idp/shibboleth" friendlyname="Gluu IDP" scoping="false" 
            avoid_subjectconfirmation="false"&gt;
                &lt;nameidpolicy enabled="false" /&gt;
                    &lt;metadata&gt;
                        &lt;file&gt;${webapp.root}/WEB-INF/metadata/idp/idp_gluu_org.xml&lt;/file&gt;
                    &lt;metadata&gt;
        &lt;/idp&gt;
</code></pre>
<p></code></p>
<h4 id="work-on-keystore">Work on keystore:</h4>
<ul>
<li>Import the SAML certificate of IDP into Asimba's JKS<ul>
<li>Convert certificate into DER format</li>
<li>Import this der formatted certificate into Asimba's keystore</li>
<li>Please note that it's a good practice to follow the IDP's <code>entityID</code> as <code>alias</code> of this certificate.</li>
</ul>
</li>
</ul>
<p>Sample command would be: </p>
<pre class="prettyprint well"><code>    keytool -import -trustcacerts -alias https://idp.gluu.org/idp/shibboleth \ 
        -file idp_gluu_org.der -keystore asimba-keystore.jks
</code></pre>
<h4 id="restart-tomcat-if-everything-goes-well-your-idp-is-configured-with-asimba">Restart tomcat. If everything goes well, your IDP is configured with Asimba</h4>
<h3 id="a-new-sp-configuration-in-asimba">A new SP configuration in Asimba</h3>
<h4 id="required-files_1">Required files:</h4>
<ul>
<li>Metadata of SP</li>
<li>SAML certificate of SP</li>
</ul>
<h4 id="configuring-asimbaxml-for-new-sp">Configuring asimba.xml for new SP:</h4>
<ul>
<li>Collect the metadata of SP and place in some location of your file system. Make sure that the metadata is in xml format and user tomcat readable.  </li>
<li>Add Requestor: Every SP is known as <code>requestor</code> to Asimba. There are couple of place where we need to configure this SP inside Asimba's asimba.xml file. <ul>
<li>Requestor should be configured in <requestorpoolfactory\\<requestors>\&lt;requestor</li>
<li><code>requestor id</code> should be the <code>entityID</code> of SP</li>
<li><code>friendlyname</code> can be anything which is unique</li>
</ul>
</li>
</ul>
<p>A sample configuration should look like below: 
<code></p>
<pre class="prettyprint well"><code>        &lt;requestor id="http://sptest2.gluu.org/secure"
                friendlyname="Gluu Test SP"
                enabled="true" /&gt;
</code></pre>
<p></code></p>
<ul>
<li>Add profile of requestor: In this section the location of SP's metadata and some other configurations are done. <ul>
<li>This configuration is configured in <profiles>\&lt;websso\&lt;requestors\&lt;requestor</li>
<li>The <code>requestor id</code> is the entityID of SP</li>
<li><code>metadata</code> location is a the absolute path</li>
</ul>
</li>
</ul>
<p>A sample configuration of requestor's profile configuration: 
<code></p>
<pre class="prettyprint well"><code>        &lt;requestor id="http://sptest2.gluu.org/secure"
            signing="FALSE"&gt;
                &lt;metadata&gt;
                    &lt;file&gt;${webapp.root}/WEB-INF/metadata/sp/sptest2_gluu_org.xml&lt;/file&gt;
                &lt;/metadata&gt;
        &lt;/requestor&gt;
</code></pre>
<p></code></p>
<h4 id="work-on-keystore_1">Work on keystore:</h4>
<ul>
<li>Import the SAML certificate of SP into Asimba's JKS<ul>
<li>Convert certificate into DER format</li>
<li>Import this der formatted certificate into Asimba's keystore</li>
<li>Please note that it's a good practice to follow the SP's <code>entityID</code> as <code>alias</code> of this certificate.</li>
</ul>
</li>
</ul>
<p>Sample command would be:</p>
<pre class="prettyprint well"><code>    keytool -import -trustcacerts -alias https://sptest2.gluu.org/secure \
        -file sp_gluu_org.der -keystore asimba-keystore.jks
</code></pre>
<h4 id="restart-tomcat-sp-is-configured-in-asimba">Restart tomcat. SP is configured in Asimba.</h4>
<h3 id="configure-sp-for-asimba-server">Configure SP for Asimba server</h3>
<p>Now, it's time to configure your SP as it can send the request to Asimba server.
The primary item to configure Asimba server in SP's configuration is <code>the
metadata of Asimba</code>. Which can be grabbed easily with </p>
<pre class="prettyprint well"><code>wget -c https://&lt;HOSTNAME&gt;/asimba-saml-proxy/profiles/saml2
</code></pre>
<h3 id="configure-remote-idp-ad-fs-for-asimba-server">Configure remote IDP / AD FS for Asimba server</h3>
<p>Remote IDP / AD FS also need to be configured for Asimba server as they can talk
together. </p>
<p>If the remote authentication server is a Shibboleth IDP, it just require three
things: </p>
<ul>
<li>Metadata of Asimba - which can be grabbed easily. </li>
<li>Name identifier attribute, which will be shared with Asimba - <code>persistentID</code></li>
<li><code>SAML2SSO</code> relying party configuration for this trust relationship with Asimba. Values should be: <ul>
<li><em>includeAttributeStatement</em> : true</li>
<li><em>assertionLifetime</em> : 300000</li>
<li><em>assertionProxyCount</em> : 0</li>
<li><em>signResponses</em> : conditional</li>
<li><em>signAssertions</em> : never</li>
<li><em>signRequests</em> : conditional</li>
<li><em>encryptAssertions</em> : never</li>
<li><em>encryptNameIds</em> : never </li>
</ul>
</li>
</ul>
<h3 id="how-to-test">How to Test</h3>
<p>The workflow of SAML Proxy is:</p>
<p>End user hit the SP --&gt; SP will take user to Asimba's discovery page to select IDP --&gt; User will select IDP for authentication --&gt; After successful
authentication user will be logged into SP</p>
<p>Gluu has an auto selector mechanism which automatically redirect user from
specified SP to desired IDP for authentication. If you want to know more, please
talk to us. </p>
</div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Copyright &copy; 2014, Gluu, Inc.</p>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../../..//js/bootstrap-3.0.3.min.js"></script>
        <script src="../../..//js/prettify-1.0.min.js"></script>
        <script src="../../..//js/base.js"></script>
        
    </body>
</html>